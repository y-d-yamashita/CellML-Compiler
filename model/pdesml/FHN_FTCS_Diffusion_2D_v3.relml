<!-- 					FHN_FTCS_Diffusion_2D_v3.relml		 			-->
<!-- Finite Difference solution in 2D for the FitzHugh-Nagumo model 	-->
<!-- with diffusion PDE and Forward-Time Central Space Scheme (FTCS)	-->

<relml>
	<tecml filename="model/tecml/FTCS_Diffusion_2D_v2.tecml" />
	<cellml filename="model/fhn2/fhn_diffusion_2D.cellml"/>
	
	<variable name="Main.time" type="dimensionvar" order="1"/>
	<variable name="Main.x1" type="dimensionvar" order="2"/>
	<variable name="Main.x2" type="dimensionvar" order="3"/>
	
	<variable name="n" type="indexvar" order="1"/>
	<variable name="j" type="indexvar" order="2"/>
	<variable name="l" type="indexvar" order="3"/>
	
	<variable name="deltat" type="deltavar" order="1"/>
	<variable name="deltax1" type="deltavar" order="2"/>
	<variable name="deltax2" type="deltavar" order="3"/>

	<variable name="Main.x" type="diffvar" />
	<variable name="Main.y" type="diffvar" />
	<variable name="Main.r" type="arithvar" />
	<variable name="Main.zz" type="arithvar" />
	<variable name="Main.epsilon" type="constvar" />
	<variable name="Main.beta" type="constvar" />
	<variable name="Main.gamma" type="constvar" />
	
	<variable name="Main.D" type="constvar" />
	
	<morphology name="2D LV wall model" filename="csv/morphology_RMesh_4x4.csv" >
		<geometry geometry-id="1" type="solid" dimension="2">
			<mesh type="RECTILINEAR_GRID" dimensions="4 4 1" spacing="1 1 1" />
		</geometry>
	</morphology>
	
	<boundary-cond variablename="Main.x" filename="csv/boundary_RMesh_4x4.csv" />
	<parameter-cond variablename="Main.epsilon" filename="csv/epsilonDP_RMesh_4x4.csv" />
	<parameter-cond variablename="Main.zz" />
	
	<math>
		<apply boundary-id="1" location="left"><eq/>
			<apply><partialdiff/>
				<bvar><ci> Main.x1 </ci></bvar>
				<ci> Main.x </ci>
			</apply>
			<cn> 0 </cn>
		</apply>
		
		<apply boundary-id="2" location="right"><eq/>
			<apply><partialdiff/>
				<bvar><ci> Main.x1 </ci></bvar>
				<ci> Main.x </ci>
			</apply>
			<cn> 0 </cn>
		</apply>
		
		<apply boundary-id="3" location="bottom"><eq/>
			<apply><partialdiff/>
				<bvar><ci> Main.x2 </ci></bvar>
				<ci> Main.x </ci>
			</apply>
			<cn> 0 </cn>
		</apply>
		
		<apply boundary-id="4" location="top"><eq/>
			<apply><partialdiff/>
				<bvar><ci> Main.x2 </ci></bvar>
				<ci> Main.x </ci>
			</apply>
			<cn> 0 </cn>
		</apply>

		<apply boundary-id="5" location="corner"><eq/>
			<ci> Main.x </ci>
			<apply><minus/>
				<cn> 1.501250563778375 </cn>
			</apply>
		</apply>
		
		<apply boundary-id="6" location="corner"><eq/>
			<ci> Main.x </ci>
			<apply><minus/>
				<cn> 1.501250563778375 </cn>
			</apply>
		</apply>
		
		<apply boundary-id="7" location="corner"><eq/>
			<ci> Main.x </ci>
			<apply><minus/>
				<cn> 1.501250563778375 </cn>
			</apply>
		</apply>
		<apply boundary-id="8" location="corner"><eq/>
			<ci> Main.x </ci>
			<apply><minus/>
				<cn> 1.501250563778375 </cn>
			</apply>
		</apply>
	
		<apply parameter-id="1"><eq/>
			<ci> Main.zz </ci>
			<piecewise>
				<piece>
					<cn> 3 </cn>
					<apply><and/>
						<apply><geq/><ci> Main.time </ci><cn> 10 </cn></apply>
						<apply><lt/><ci> Main.time </ci><cn> 12 </cn></apply>
						<apply><eq/><ci> j </ci><cn> 1 </cn></apply>
						<apply><eq/><ci> l </ci><cn> 1 </cn></apply>
					</apply>
				</piece>
				<otherwise>
					<cn> 0 </cn>
				</otherwise>
			</piecewise>
		</apply>
	</math>

</relml>