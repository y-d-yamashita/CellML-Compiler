<!-- 					LR1_FTCS_Diffusion_2D.relml		 			-->
<!-- Finite Difference solution in 1D for Luo-Rudy 1991 model 		-->
<!-- with diffusion PDE and Forward-Time Central Space Scheme (FTCS)-->

<relml>
	<tecml filename="model/tecml/FTCS_Diffusion_1D.tecml" />
	<cellml filename="model/luo_rudy_1991/luo_rudy_1991.cellml" />	
	
	<variable name="intracellular_calcium_concentration.time" type="dimensionvar" order="1"/>
	<variable name="x1" type="dimensionvar" order="2"/>
	
	<variable name="n" type="indexvar" order="1"/>
	<variable name="j" type="indexvar" order="2"/>
	
	<variable name="deltat" type="deltavar" order="1"/>
	<variable name="deltax1" type="deltavar" order="2"/>
	
	<variable name="membrane.V" type="diffvar" />
	<variable name="fast_sodium_current.m" type="diffvar" />
	<variable name="fast_sodium_current.h" type="diffvar" />
	<variable name="fast_sodium_current.j" type="diffvar" />
	<variable name="slow_inward_current.d" type="diffvar" />
	<variable name="slow_inward_current.f" type="diffvar" />
	<variable name="time_dependent_potassium_current.X" type="diffvar" />
	<variable name="slow_inward_current.Cai" type="diffvar" />
	
	<variable name="membrane.I_stim" type="arithvar" />
	<variable name="membrane.i_Na" type="arithvar" />
	<variable name="membrane.i_si" type="arithvar" />
	<variable name="membrane.i_K" type="arithvar" />
	<variable name="membrane.i_K1" type="arithvar" />
	<variable name="membrane.i_Kp" type="arithvar" />
	<variable name="membrane.i_b" type="arithvar" />
	<variable name="fast_sodium_current.E_Na" type="arithvar" />
	<variable name="fast_sodium_current_m_gate.alpha_m" type="arithvar" />
	<variable name="fast_sodium_current_m_gate.beta_m" type="arithvar" />
	<variable name="fast_sodium_current_h_gate.alpha_h" type="arithvar" />
	<variable name="fast_sodium_current_h_gate.beta_h" type="arithvar" />
	<variable name="fast_sodium_current_j_gate.alpha_j" type="arithvar" />
	<variable name="fast_sodium_current_j_gate.beta_j" type="arithvar" />
	<variable name="slow_inward_current.E_si" type="arithvar" />
	<variable name="slow_inward_current_d_gate.alpha_d" type="arithvar" />
	<variable name="slow_inward_current_d_gate.beta_d" type="arithvar" />
	<variable name="slow_inward_current_f_gate.alpha_f" type="arithvar" />
	<variable name="slow_inward_current_f_gate.beta_f" type="arithvar" />
	<variable name="time_dependent_potassium_current.g_K" type="arithvar" />
	<variable name="time_dependent_potassium_current.E_K" type="arithvar" />
	<variable name="time_dependent_potassium_current.Xi" type="arithvar" />
	<variable name="time_dependent_potassium_current_X_gate.alpha_X" type="arithvar" />
	<variable name="time_dependent_potassium_current_X_gate.beta_X" type="arithvar" />
	<variable name="time_independent_potassium_current.g_K1" type="arithvar" />
	<variable name="time_independent_potassium_current.E_K1" type="arithvar" />
	<variable name="time_independent_potassium_current.K1" type="arithvar" />
	<variable name="time_independent_potassium_current_K1_gate.alpha_K1" type="arithvar" />
	<variable name="time_independent_potassium_current_K1_gate.beta_K1" type="arithvar" />
	<variable name="plateau_potassium_current.E_Kp" type="arithvar" />
	<variable name="plateau_potassium_current.Kp" type="arithvar" />
	
	<variable name="membrane.R" type="constvar" />
	<variable name="membrane.T" type="constvar" />
	<variable name="membrane.F" type="constvar" />
	<variable name="membrane.C" type="constvar" />
	<variable name="membrane.stim_start" type="constvar" />
	<variable name="membrane.stim_end" type="constvar" />
	<variable name="membrane.stim_period" type="constvar" />
	<variable name="membrane.stim_duration" type="constvar" />
	<variable name="membrane.stim_amplitude" type="constvar" />
	<variable name="fast_sodium_current.g_Na" type="constvar" />
	<variable name="time_dependent_potassium_current.g_Kbar" type="constvar" />
	<variable name="background_current.g_b" type="constvar" />
	<variable name="time_dependent_potassium_current.Nai" type="constvar" />
	<variable name="time_dependent_potassium_current.Nao" type="constvar" />
	<variable name="plateau_potassium_current.g_Kp" type="constvar" />
	<variable name="background_current.E_b" type="constvar" />
	<variable name="time_independent_potassium_current.Ki" type="constvar" />
	<variable name="time_independent_potassium_current.Ko" type="constvar" />
	<variable name="time_dependent_potassium_current.PR_NaK" type="constvar" />
	
	<variable name="boundary_value_A" type="constvar" />
	<variable name="boundary_value_B" type="constvar" />

	<morphology name="1D LV wall model">
		<geometry geometry-id="1" type="solid" dimension="1">
			<mesh type="RECTILINEAR_GRID" dimensions="3 1 1" spacing="1 1 1" />
		</geometry>
		
		<boundary-cond boundary-id="1">
			<math xmlns="http://www.w3.org/1998/Math/MathML">
				<apply boundary-type="Dirichlet"><eq/>
					<apply><minus/>
						<apply><selector/>
							<ci> membrane.V </ci>
							<ci> n </ci>
							<cn> 0 </cn>
						</apply>
						<apply><selector/>
							<ci> membrane.V </ci>
							<ci> n </ci>
							<apply><minus/>
								<cn> 1 </cn>
							</apply>	
						</apply>
					</apply>
					<ci> boundary_value_A </ci>
				</apply>
				
				<apply boundary-type="Dirichlet"><eq/>
					<apply><minus/>
						<apply><selector/>
							<ci> membrane.V </ci>
							<ci> n </ci>
							<cn> 3 </cn>
						</apply>
						<apply><selector/>
							<ci> membrane.V </ci>
							<ci> n </ci>
							<cn> 2 </cn>
						</apply>
					</apply>
					<ci> boundary_value_B </ci>
				</apply>
			</math>
		</boundary-cond>
		
		<parameter-cond parameter-id="1">
			<math>
				<apply><eq/>
					<ci> time_dependent_potassium_current.g_Kbar </ci>
					<cn> 0.434 </cn>
				</apply>
				<apply><condition/>
			</math>	
		</parameter-cond>
	</morphology>	

	
</relml>